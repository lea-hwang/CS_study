## Q13. 커널 수준 스레드와 사용자 수준 스레드에 대해 설명해주세요.

### 🔎 스레드

프로세스 내 작업 단위/실행되는 실행 단위

<img src="https://blog.kakaocdn.net/dn/CG9Z6/btqIXf0Prke/jzEIWyDsk6zXlWkxdlKMEk/img.png" alt="img" style="zoom:67%;" />



#### 종류

> - 커널 수준 스레드
> - 사용자 수준 스레드



### 🔎 커널 수준 스레드

![img](https://blog.kakaocdn.net/dn/cPkDlx/btqIVGRWgub/skQoT9zDCDEYhkJwFaY6w0/img.png)

커널 레벨에서 생성되는 스레드.

운영체제 시스템 내에서 생성되어 동작하는 스레드로, 커널이 직접 관리한다.

커널 수준에서는 프로세스가 주기억 장치에 여러 개가 적재되어 CPU 할당을 기다리며 동작한다.

> **context switching**
>
> **CPU에서 인터럽트 발생으로** 현재 작업 중인 프로세스가 Block 되고 다른 프로세스로 변경할 때, CPU 내 재배치 레지스터에 **다음에 실행할 프로세스 정보들로 교체를 하고 캐시를 비운다**.
>
> 컨텍스트 스위칭이 일어날 때는 CPU가 일을 못한다. 그래서 이게 자주 일어나면 성능에 영향이 발생하게 되는 단점이 있다.

커널이 직접 관리하므로 특정 스레드가 Block이 되어도 다른 스레드들은 독립적으로 일을 할 수 있다.



### 🔎 사용자 수준 스레드

![img](https://blog.kakaocdn.net/dn/bsoqGn/btqIXgZKXUd/W0xNAw2lKS2AuIoofkbY01/img.png)

스레드를 관리하는 라이브러리로 인해 사용자 단에서 생성 및 관리되는 스레드 -> 커널이 따로 관리하지 X, 이 스레드에 대해서 알지도 못한다.

=> 커널 수준 밖의 스레드. **물리적 위치는 커널 내부이지만 커널의 통제권 밖에 있다.**

***입출력 인터럽트가 발생 -> 커널은 '사용자 모드'가 됨 -> 사용자 수준 스레드의 응답을 기다림 -> 사용자 수준 스레드의 응답이 옴 -> 다시 '커널 모드'로 변환되어 이어서 커널 스레드가 일 처리를 하게 됨***

=> 사용자 모드에서 동작하는 스레드가 사용자 수준 스레드.

운영체제 단의 기능을 하는 것이 아니라, 개발자가 기능 구현할 때 현재 기능 내에서 일 처리를 하는 스레드를 만들 듯이, **프로세스 내 커널과 관련 없는 기능들만 수행**하는 스레드이다. => **컨텍스트 스위칭이 없고, 스레드 교체 등으로 인한 오버헤드 발생이 없다.**

**인터럽트를 당하면** 커널 수준 스레드와는 다르게 **사용자 수준의 스레드들은 모두 함께 Block**이 된다.



#### 커널 수준 스레드와 사용자 수준 스레드 장/단점

- **커널 레벨 스레드의 장점**은 커널이 직접 제공해 주기 때문에 **안정성과 다양한 기능이 제공**된다.
- **커널 레벨 스레드의 단점**은 유저 모드에서 커널 모드로의 **전환이 빈번하게 이뤄져 성능 저하가 발생**한다.
- **유저 레벨 스레드의 장점**은 커널은 쓰레드의 존재조차 모르기 때문에 **모드 간의 전환이 없고 성능 이득이 발생**한다.
- **유저 레벨 스레드의 단점**은 **하나의 스레드가 커널에 의해 블로킹 되면 프로세스 전체가 블로킹**되고,
  이를 해결하려면 **프로그래밍이 어려워지고 커널 레벨 쓰레드에 비해 결과 예측이 어려워진다.**





참고)

https://helloinyong.tistory.com/293

https://junghyun100.github.io/%EC%82%AC%EC%9A%A9%EC%9E%90%EC%88%98%EC%A4%80ThreadVS%EC%BB%A4%EB%84%90%EC%88%98%EC%A4%80Thread/

https://coding-start.tistory.com/199

https://velog.io/@taehee-kim-dev/%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%88%98%EC%A4%80-%EC%8A%A4%EB%A0%88%EB%93%9C-%EC%BB%A4%EB%84%90-%EC%88%98%EC%A4%80-%EC%8A%A4%EB%A0%88%EB%93%9C